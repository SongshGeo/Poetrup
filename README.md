# æ‹¼è´´è¯— - Poetry Collage App

**Poetrup** - ä¸€ä¸ªä¼˜é›…çš„ä¸­æ–‡è¯è¯­é‡‡é›†ä¸æ‹¼è´´è¯—åˆ›ä½œåº”ç”¨

> ğŸ‡ºğŸ‡¸ [English Version](./README_EN.md) | ğŸ‡¨ğŸ‡³ ä¸­æ–‡ç‰ˆï¼ˆå½“å‰ï¼‰

---

## ğŸ“– å…³äºæœ¬é¡¹ç›®

**æ‹¼è´´è¯—ï¼ˆPoetrupï¼‰** æ˜¯ä¸€ä¸ªä¸“æ³¨äºä¸­æ–‡è¯è¯­é‡‡é›†å’Œæ‹¼è´´è¯—åˆ›ä½œçš„ Web åº”ç”¨ã€‚ç”¨æˆ·å¯ä»¥æ”¶é›†å–œæ¬¢çš„è¯è¯­ï¼Œå°†å®ƒä»¬åˆ†ç±»æ•´ç†åˆ°ä¸åŒçš„æ”¶è—å†Œä¸­ï¼Œå¹¶é€šè¿‡æ‹–æ‹½çš„æ–¹å¼åˆ›ä½œç‹¬ç‰¹çš„æ‹¼è´´è¯—ä½œå“ã€‚

### æ ¸å¿ƒåŠŸèƒ½

- ğŸ“ **è¯è¯­ç®¡ç†**
  - æ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤è¯è¯­
  - æ”¯æŒè‡ªå®šä¹‰æ ‡ç­¾åˆ†ç±»
  - è¯è¯­ä½¿ç”¨ç»Ÿè®¡

- ğŸ“š **æ”¶è—å†Œ**
  - åˆ›å»ºå¤šä¸ªæ”¶è—å†Œæ¥ç»„ç»‡è¯è¯­
  - æ”¯æŒå…¬å¼€ã€å…±äº«ã€ç§å¯†ä¸‰ç§å¯è§æ€§
  - æ‹–æ‹½è¯è¯­åˆ°æ”¶è—å†Œ

- âœï¸ **æ‹¼è´´è¯—åˆ›ä½œ**
  - å¯è§†åŒ–æ‹–æ‹½åˆ›ä½œç•Œé¢
  - æ”¯æŒè¯è¯­ä½ç½®ã€æ—‹è½¬ã€é¢œè‰²è‡ªå®šä¹‰
  - ä½œå“ä¿å­˜å’Œç¼–è¾‘

- ğŸ·ï¸ **æ ‡ç­¾ç³»ç»Ÿ**
  - ä¸ºè¯è¯­æ·»åŠ æ ‡ç­¾è¿›è¡Œåˆ†ç±»
  - æ”¯æŒè‡ªå®šä¹‰æ ‡ç­¾ç±»åˆ«
  - æŒ‰æ ‡ç­¾ç­›é€‰è¯è¯­

- ğŸ‘¤ **ç”¨æˆ·ç³»ç»Ÿ**
  - ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
  - ä¸ªäººä½œå“é›†ç®¡ç†
  - ç”¨æˆ·åå¥½è®¾ç½®ï¼ˆä¿å­˜åœ¨ profile.metadataï¼‰

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### Frontend / å‰ç«¯
- **Next.js 15** (App Router)
- **React 19**
- **Tailwind CSS** - æ ·å¼æ¡†æ¶
- **shadcn/ui** - UI ç»„ä»¶åº“
- **React DnD** - æ‹–æ‹½åŠŸèƒ½
- **Sonner** - Toast é€šçŸ¥
- **next-themes** - ä¸»é¢˜ç®¡ç†

### Backend / åç«¯
- **Supabase** - åç«¯å³æœåŠ¡ï¼ˆBaaSï¼‰
  - PostgreSQL æ•°æ®åº“
  - Row Level Security (RLS)
  - Authentication
  - Storage Buckets
  - Edge Functionsï¼ˆä¸­æ–‡åˆ†è¯ï¼‰

### è®¾è®¡
- å‰ç«¯è®¾è®¡æ¥è‡ª [Poetrupfrontend](https://github.com/SongshGeo/Poetrupfrontend.git)
- çº¸å¼ çº¹ç†ä¸»é¢˜ï¼Œä¼˜é›…çš„è§†è§‰ä½“éªŒ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

1. Node.js 18+ å’Œ Yarn
2. Supabase è´¦æˆ·å’Œé¡¹ç›®
3. Supabase CLIï¼ˆç”¨äºæ•°æ®åº“è¿ç§»ï¼‰

### å®‰è£…æ­¥éª¤

#### 1. å…‹éš†ä»“åº“

```bash
git clone https://github.com/SongshGeo/Poetrup.git
cd Poetrup
```

#### 2. è¿æ¥ Supabase é¡¹ç›®

```bash
# ç™»å½• Supabase
npx supabase login

# è¿æ¥åˆ°ä½ çš„ Supabase é¡¹ç›®ï¼ˆä¼šæç¤ºé€‰æ‹©é¡¹ç›®ï¼‰
npx supabase link

# æ¨é€é…ç½®åˆ°æœåŠ¡å™¨
npx supabase config push
```

#### 3. è¿è¡Œæ•°æ®åº“è¿ç§»

```bash
# æ‰§è¡Œæ‰€æœ‰è¿ç§»æ–‡ä»¶
npx supabase migrations up --linked
```

è¿™å°†åˆ›å»ºä»¥ä¸‹æ•°æ®åº“ç»“æ„ï¼š
- `profiles` - ç”¨æˆ·æ¡£æ¡ˆ
- `words` - è¯è¯­è¡¨
- `collections` - æ”¶è—å†Œè¡¨
- `collection_words` - è¯è¯­ä¸æ”¶è—å†Œå…³è”è¡¨
- `poetry` - ä½œå“è¡¨
- `poetry_collections` - ä½œå“ä¸æ”¶è—å†Œå…³è”è¡¨
- `favorites` - æ”¶è—è¡¨

è¯¦ç»†è¿ç§»æŒ‡å—è¯·æŸ¥çœ‹ï¼š[docs/MIGRATION_GUIDE.md](./docs/MIGRATION_GUIDE.md)

#### 4. é…ç½®ç¯å¢ƒå˜é‡

åœ¨ `nextjs/.env.local` æ–‡ä»¶ä¸­é…ç½®ï¼š

```env
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
PRIVATE_SUPABASE_SERVICE_KEY=your_service_role_key
```

ä½ å¯ä»¥åœ¨ Supabase æ§åˆ¶å°çš„ `é¡¹ç›®è®¾ç½®` -> `API` ä¸­æ‰¾åˆ°è¿™äº›å¯†é’¥ã€‚

#### 5. å®‰è£…ä¾èµ–å¹¶å¯åŠ¨

```bash
cd nextjs
yarn install
yarn dev
```

è®¿é—® http://localhost:3000 ğŸ‰

## ğŸ“ å‰ç«¯ä»£ç æ›´æ–°

æœ¬é¡¹ç›®é›†æˆäº†æ¥è‡ª [Poetrupfrontend](https://github.com/SongshGeo/Poetrupfrontend.git) çš„å‰ç«¯è®¾è®¡ã€‚

**å¿«é€Ÿæ›´æ–°å‰ç«¯ä»£ç ï¼š**
```bash
./scripts/update-frontend.sh
```

è¯¦ç»†æ›´æ–°æŒ‡å—è¯·æŸ¥çœ‹ï¼š[docs/å‰ç«¯æ›´æ–°ååŒæ­¥æŒ‡å—.md](./docs/å‰ç«¯æ›´æ–°ååŒæ­¥æŒ‡å—.md)

## ğŸ“š é¡¹ç›®ç»“æ„

```
Poetrup/
â”œâ”€â”€ nextjs/                    # Next.js å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/              # App Router é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ app/          # ä¸»åº”ç”¨é¡µé¢ï¼ˆæ‹¼è´´è¯—ï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx              # ä¸»é¡µé¢ï¼ˆè¯è¯­ç®¡ç†ï¼‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ poetry/               # ä½œå“ç›¸å…³é¡µé¢
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ collection/       # ä½œå“é›†
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ edit/[id]/       # ç¼–è¾‘ä½œå“
â”‚   â”‚   â”‚   â””â”€â”€ auth/         # è®¤è¯é¡µé¢
â”‚   â”‚   â”œâ”€â”€ components/       # React ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/           # shadcn/ui ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ ...           # ä¸šåŠ¡ç»„ä»¶
â”‚   â”‚   â””â”€â”€ lib/              # å·¥å…·å‡½æ•°å’Œ API
â”‚   â”‚       â”œâ”€â”€ api/          # Supabase API å°è£…
â”‚   â”‚       â”‚   â”œâ”€â”€ words.ts      # è¯è¯­ API
â”‚   â”‚       â”‚   â”œâ”€â”€ collections.ts # æ”¶è—å†Œ API
â”‚   â”‚       â”‚   â””â”€â”€ poetry.ts    # ä½œå“ API
â”‚   â”‚       â””â”€â”€ utils/        # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ supabase/                  # Supabase é…ç½®å’Œè¿ç§»
â”‚   â”œâ”€â”€ migrations/           # æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”‚   â”œâ”€â”€ functions/            # Edge Functions
â”‚   â””â”€â”€ config.toml           # Supabase é…ç½®
â”œâ”€â”€ scripts/                   # å·¥å…·è„šæœ¬
â”‚   â””â”€â”€ update-frontend.sh    # å‰ç«¯æ›´æ–°è„šæœ¬
â””â”€â”€ docs/                      # æ–‡æ¡£
    â”œâ”€â”€ MIGRATION_GUIDE.md     # è¿ç§»æŒ‡å—
    â””â”€â”€ å‰ç«¯æ›´æ–°ååŒæ­¥æŒ‡å—.md  # å‰ç«¯æ›´æ–°æŒ‡å—
```

## ğŸ”‘ æ ¸å¿ƒåŠŸèƒ½è¯´æ˜

### è¯è¯­ç®¡ç†

- ç”¨æˆ·å¯ä»¥æ·»åŠ ä¸­æ–‡è¯è¯­ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æå–æ ‡ç­¾ï¼ˆå¦‚ `#ç”µå½±`ã€`#å¿ƒæƒ…`ï¼‰
- è¯è¯­å¯ä»¥å…³è”å¤šä¸ªæ ‡ç­¾
- æ”¯æŒæœç´¢å’Œç­›é€‰

### æ”¶è—å†Œ

- åˆ›å»ºæ”¶è—å†Œæ¥ç»„ç»‡è¯è¯­
- æ”¯æŒä¸‰ç§å¯è§æ€§ï¼šç§å¯†ã€å…±äº«ã€å…¬å¼€
- é€šè¿‡æ‹–æ‹½å°†è¯è¯­æ·»åŠ åˆ°æ”¶è—å†Œ

### æ‹¼è´´è¯—åˆ›ä½œ

- å¯è§†åŒ–åˆ›ä½œç•Œé¢ï¼Œæ”¯æŒæ‹–æ‹½è¯è¯­åˆ°ç”»å¸ƒ
- æ¯ä¸ªè¯è¯­å¯ä»¥è®¾ç½®ä½ç½®ã€æ—‹è½¬è§’åº¦ã€é¢œè‰²
- ä½œå“å†…å®¹ä»¥ JSONB æ ¼å¼å­˜å‚¨åœ¨æ•°æ®åº“ä¸­

### æ•°æ®æŒä¹…åŒ–

æ‰€æœ‰æ“ä½œéƒ½ä¼šè‡ªåŠ¨ä¿å­˜åˆ° Supabase æ•°æ®åº“ï¼š
- åˆ›å»ºè¯è¯­ â†’ `words` è¡¨
- åˆ›å»ºæ”¶è—å†Œ â†’ `collections` è¡¨
- æ‹–åŠ¨è¯è¯­åˆ°æ”¶è—å†Œ â†’ `collection_words` è¡¨
- åˆ›å»º/ç¼–è¾‘ä½œå“ â†’ `poetry` è¡¨
- åˆ›å»ºæ ‡ç­¾ â†’ `profile.metadata.tags`

## ğŸ“– æ–‡æ¡£

- [æ•°æ®åº“è¿ç§»æŒ‡å—](./docs/MIGRATION_GUIDE.md)
- [æœ¬åœ°åŒæ­¥åˆ°äº‘ç«¯æŒ‡å—](./docs/SYNC_TO_CLOUD.md)
- [å‰ç«¯æ›´æ–°æŒ‡å—](./docs/å‰ç«¯æ›´æ–°ååŒæ­¥æŒ‡å—.md)
- [API æ–‡æ¡£](./nextjs/src/lib/api/README.md)

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- **Row Level Security (RLS)** - æ•°æ®åº“è¡Œçº§å®‰å…¨ç­–ç•¥
- **ç”¨æˆ·è®¤è¯** - Supabase Auth é›†æˆ
- **æ•°æ®éš”ç¦»** - ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®

## ğŸš€ éƒ¨ç½²

### Vercel éƒ¨ç½²ï¼ˆæ¨èï¼‰

è¯¦ç»†éƒ¨ç½²æŒ‡å—è¯·æŸ¥çœ‹ï¼š[éƒ¨ç½²æŒ‡å—](./docs/DEPLOYMENT_GUIDE.md)

**å¿«é€Ÿæ­¥éª¤ï¼š**

1. å°†ä»£ç æ¨é€åˆ° GitHub
2. åœ¨ [Vercel](https://vercel.com) åˆ›å»ºé¡¹ç›®ï¼Œé€‰æ‹©ä½ çš„ä»“åº“
3. **é‡è¦**ï¼šè®¾ç½® Root Directory ä¸º `nextjs`
4. åœ¨ Vercel é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ç¯å¢ƒå˜é‡ï¼š
   - `NEXT_PUBLIC_SUPABASE_URL`
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY`
   - `PRIVATE_SUPABASE_SERVICE_KEY`
5. ç‚¹å‡»éƒ¨ç½²
6. åœ¨ Supabase Dashboard é…ç½®é‡å®šå‘ URLï¼ˆ`é¡¹ç›®è®¾ç½®` -> `Authentication` -> `URL Configuration`ï¼‰

### åˆ›å»ºæµ‹è¯•ç”¨æˆ·

éƒ¨ç½²åï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ›å»ºæµ‹è¯•ç”¨æˆ·ï¼š

1. **Supabase Dashboard**ï¼ˆæ¨èï¼‰ï¼š
   - è®¿é—® https://supabase.com/dashboard/project/qsqohnmpxuxgeijjosrg
   - è¿›å…¥ `Authentication` -> `Users` -> `Add user`
   - åˆ›å»ºæ–°ç”¨æˆ·å¹¶å‹¾é€‰ "Auto Confirm User"

2. **åº”ç”¨æ³¨å†Œé¡µé¢**ï¼š
   - è®¿é—®éƒ¨ç½²åçš„åº”ç”¨ URL
   - ä½¿ç”¨æ³¨å†ŒåŠŸèƒ½åˆ›å»ºè´¦å·

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·éšæ—¶æäº¤ Pull Requestã€‚

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ Apache License 2.0 è®¸å¯è¯ - è¯¦è§ LICENSE æ–‡ä»¶ã€‚

## ğŸ™ è‡´è°¢

- [Next.js](https://nextjs.org/)
- [Supabase](https://supabase.com/)
- [Tailwind CSS](https://tailwindcss.com/)
- [shadcn/ui](https://ui.shadcn.com/)
- å‰ç«¯è®¾è®¡ï¼š[Poetrupfrontend](https://github.com/SongshGeo/Poetrupfrontend.git)

---

**äº«å—åˆ›ä½œæ‹¼è´´è¯—çš„ä¹è¶£ï¼** ğŸ¨âœ¨
